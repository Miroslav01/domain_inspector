<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Domain Inspector</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: #fff;
            margin: 0;
            padding: 0;
        }
        .container {
            margin: 0 auto;
            padding: 24px 0 0 0;
            /* max-width removed for full width */
        }
        .title {
            text-align: center;
            font-size: 2.8rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
        }
        .input-row {
            display: flex;
            justify-content: center;
            gap: 0.75rem;
            margin-bottom: 2rem;
        }
        .input-row input[type="text"] {
            font-size: 1.1rem;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            border: 1px solid #ccc;
            width: 350px;
        }
        .input-row button {
            font-size: 1.1rem;
            padding: 0.5rem 1.2rem;
            border-radius: 6px;
            border: none;
            background: #1976d2;
            color: #fff;
            font-weight: 600;
            cursor: pointer;
        }
        .panels-row {
            display: flex;
            gap: 2rem;
            justify-content: space-between;
            align-items: flex-start;
            width: 100vw;
            padding: 0 2vw;
            box-sizing: border-box;
        }
        .panel {
            flex: 1 1 0;
            min-width: 220px;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.07);
            border: 1px solid #e0e0e0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        .panel-header {
            font-size: 1.25rem;
            font-weight: 600;
            padding: 0.8rem 1rem;
            border-bottom: 1px solid #e0e0e0;
        }
        .panel-header.dns { background: #1976d2; color: #fff; }
        .panel-header.whois { background: #757575; color: #fff; }
        .panel-header.curl { background: #222; color: #fff; }
        .panel-header.analysis { background: #00cfff; color: #222; }
        .panel-body {
            padding: 1rem;
            font-size: 1.05rem;
            flex: 1;
        }
        .dns-record-label {
            font-weight: bold;
            font-size: 1em;
            margin-bottom: 0.15em;
        }
        .long-txt-record {
            max-height: 6em;
            overflow-y: auto;
            font-size: 0.97em;
            background: #f9fafc;
            border-radius: 4px;
            padding: 0.5em;
            scrollbar-width: thin;
            scrollbar-color: #bbb #f9fafc;
        }
        .long-txt-record::-webkit-scrollbar {
            width: 6px;
            background: #f9fafc;
        }
        .long-txt-record::-webkit-scrollbar-thumb {
            background: #bbb;
            border-radius: 6px;
        }
        .checked-domain-name {
            color: #fff;
            font-size: 1.2rem;
            font-weight: bold;
            padding-left: 0.25em;
        }
        @media (max-width: 1100px) {
            .panels-row {
                gap: 1rem;
            }
        }
        @media (max-width: 900px) {
            .panels-row {
                flex-direction: column;
                gap: 2rem;
                width: 100%;
                padding: 0;
            }
        }
    </style>
</head>
<body>
<div class="container">
    <div class="title">Domain Inspector</div>
    <form method="post">
        <div class="input-row">
            <input type="text" id="domain" name="domain" placeholder="example.com or 8.8.8.8" value="{{ domain }}">
            <button type="submit">Inspect</button>
        </div>
    </form>
    <div class="panels-row">
        <div class="panel">
            <div class="panel-header dns">DNS Info{% if domain %} for <span class="checked-domain-name">{{ domain }}</span>{% endif %}</div>
            <div class="panel-body">
                {% if domain_info %}
                <table style="width:100%; border-collapse:collapse; font-size:0.89em;">
                    <tbody>
                        <tr>
                            <td class="dns-record-label" style="width: 95px; padding: 0.25em 0.4em; font-weight: normal; vertical-align: top; white-space:nowrap;">A</td>
                            <td style="padding: 0.25em 0.4em; vertical-align: top;">
                                {% if domain_info.dns.A and domain_info.dns.A|length > 0 %}
                                    <span style="font-size:0.95em; font-family:inherit; font-weight:normal; white-space:nowrap;">{{ domain_info.dns.A | join(' ') }}</span>
                                {% else %}
                                    <span class="text-muted" style="font-size:0.95em; font-family:inherit; font-weight:normal;">No A records found</span>
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <td class="dns-record-label" style="width: 95px; padding: 0.25em 0.4em; font-weight: normal; vertical-align: top; white-space:nowrap;">WWW</td>
                            <td style="padding: 0.25em 0.4em; vertical-align: top;">
                                {% if domain_info.dns.WWW_A and domain_info.dns.WWW_A|length > 0 %}
                                    <span style="font-size:0.95em; font-family:inherit; font-weight:normal; white-space:nowrap;">{{ domain_info.dns.WWW_A | join(' ') }}</span>
                                {% else %}
                                    <span class="text-muted" style="font-size:0.95em; font-family:inherit; font-weight:normal;">No WWW A records found</span>
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <td class="dns-record-label" style="width: 95px; padding: 0.25em 0.4em; font-weight: normal; vertical-align: top; white-space:nowrap;">IPv6</td>
                            <td style="padding: 0.25em 0.4em; vertical-align: top;">
                                {% if domain_info.dns.AAAA and domain_info.dns.AAAA|length > 0 %}
                                    <span style="font-size:0.95em; font-family:inherit; font-weight:normal; white-space:nowrap;">{{ domain_info.dns.AAAA | join(' ') }}</span>
                                {% else %}
                                    <span class="text-muted" style="font-size:0.95em; font-family:inherit; font-weight:normal;">No IPv6 Found</span>
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <td class="dns-record-label" style="width: 95px; padding: 0.25em 0.4em; font-weight: normal; vertical-align: top;">MX</td>
                            <td style="padding: 0.25em 0.4em;">
                                {% if domain_info.dns.MX and domain_info.dns.MX|length > 0 %}
                                    <div style="font-size:0.87em;">
                                        {% for mx in domain_info.dns.MX %}
                                            <div style="white-space:nowrap; overflow-x:auto; max-width:100%; scrollbar-width:none; -ms-overflow-style:none;">{{ mx }}</div>
                                        {% endfor %}
                                    </div>
                                {% else %}
                                    <span class="text-muted">No MX records found</span>
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <td class="dns-record-label" style="width: 95px; padding: 0.25em 0.4em; font-weight: normal; vertical-align: top; white-space:nowrap;">TXT</td>
                            <td style="padding: 0.25em 0.4em; vertical-align: top;">
                                {% if domain_info.dns.TXT is defined and domain_info.dns.TXT|length > 0 %}
                                    <div style="max-width: 100%; max-height: 5.5em; overflow-y: auto; overflow-x: hidden; white-space: normal; scrollbar-width: thin; -ms-overflow-style: none;">
                                        {% set txts = domain_info.dns.TXT %}
                                        {% set spf = None %}
                                        {% set non_spf = [] %}
                                        {% for txt in txts %}
                                            {% if txt.startswith('v=spf1') and spf is none %}
                                                {% set spf = txt %}
                                            {% else %}
                                                {% set _ = non_spf.append(txt) %}
                                            {% endif %}
                                        {% endfor %}
                                        {% set shown = 0 %}
                                        {% if spf %}
                                            <div style="font-size:0.87em; background:none; border:none; white-space:nowrap; overflow-x:auto; text-overflow:ellipsis;">{{ spf }}</div>
                                            {% set shown = shown + 1 %}
                                        {% endif %}
                                        {% for txt in non_spf %}
                                            {% if shown < 4 %}
                                                <div style="font-size:0.87em; background:none; border:none; white-space:normal; word-break:break-all;">{{ txt }}</div>
                                                {% set shown = shown + 1 %}
                                            {% endif %}
                                        {% endfor %}
                                        {% if txts|length > (4 if spf else 3) %}
                                            <div style="font-size:0.87em; color:#888;">...and {{ txts|length - (4 if spf else 3) }} more (scroll to view)</div>
                                        {% endif %}
                                    </div>
                                {% else %}
                                    <span class="text-muted">No TXT records found</span>
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <td class="dns-record-label" style="width: 95px; padding: 0.25em 0.4em; font-weight: normal; vertical-align: top;">NS</td>
                            <td style="padding: 0.25em 0.4em; vertical-align: top;">
                                {% if domain_info.dns.NS and domain_info.dns.NS|length > 0 %}
                                    <div style="font-size:0.95em; font-family:inherit; font-weight:normal;">
                                        {% for ns in domain_info.dns.NS %}
                                            <div style="white-space:nowrap;">{{ ns }}</div>
                                        {% endfor %}
                                    </div>
                                {% else %}
                                    <span class="text-muted" style="font-size:0.95em; font-family:inherit; font-weight:normal;">No NS records found</span>
                                {% endif %}
                            </td>
                        </tr>
                        <tr>
                            <td class="dns-record-label" style="width: 95px; padding: 0.25em 0.4em; font-weight: normal; vertical-align: top;">DNSSEC</td>
                            <td style="word-break:break-all; padding: 0.25em 0.4em;">
                                {% if domain_info.dns.dnssec %}
                                    <span class="badge bg-success">Enabled</span>
                                {% else %}
                                    <span class="badge bg-danger">Not enabled</span>
                                {% endif %}
                            </td>
                        </tr>
                    </tbody>
                </table>
                {% else %}
                <div class="text-muted">No DNS info yet.</div>
                {% endif %}
            </div>
        </div>
        <div class="panel">
            <div class="panel-header whois">WHOIS Info{% if domain %} for <span class="checked-domain-name">{{ domain }}</span>{% endif %}</div>
            <div class="panel-body">
                {% if domain_info %}
                    <ul style="padding-left:1em;">
                        <li><b>Registrar:</b> {{ domain_info.whois.registrar }}</li>
                        <li><b>Expiration Date:</b> {{ domain_info.whois.expiration }}</li>
                        <li>
                            <b>Status:</b>
                            {% if domain_info.whois.statuses and domain_info.whois.statuses|length > 0 %}
                                <ul>
                                    {% for s in domain_info.whois.statuses %}
                                        <li>{{ s }}</li>
                                    {% endfor %}
                                </ul>
                            {% else %}
                                <span class="text-muted">No status info</span>
                            {% endif %}
                        </li>
                    </ul>
                    <details>
                        <summary>Raw WHOIS</summary>
                        <pre class="small">{{ domain_info.whois.raw }}</pre>
                    </details>
                {% else %}
                    <div class="text-muted">No WHOIS info yet.</div>
                {% endif %}
            </div>
        </div>
        <div class="panel">
            <div class="panel-header curl">CURL GET Info{% if domain %} for <span class="checked-domain-name">{{ domain }}</span>{% endif %}</div>
            <div class="panel-body">
                {% if curl_info %}
                <details>
                    <summary>HTTP Response Headers</summary>
                    <pre class="small">{{ curl_info.headers }}</pre>
                </details>
                <h6 class="mt-3">Analysis</h6>
                <ul>
                    {% for a in curl_info.analysis %}
                        <li {% if 'Missing' in a %}style="color:#d32f2f;"{% endif %}>{{ a }}</li>
                    {% endfor %}
                </ul>
                {% else %}
                <div class="text-muted">No CURL info yet.</div>
                {% endif %}
            </div>
        </div>
        <div class="panel">
            <div class="panel-header analysis">Analysis</div>
            <div class="panel-body">
                <div class="text-muted">Analysis and conclusions will appear here.</div>
            </div>
        </div>
    </div>
</div>
</body>
</html>