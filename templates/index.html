<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Domain Inspector</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<!-- Main container for Domain Inspector UI -->
<div class="container">
    <!-- App Title -->
    <div class="title">Domain Inspector</div>
    <!-- Domain input form -->
    <form method="post">
    <div class="input-row">
            <input type="text" id="domain" name="domain" placeholder="example.com or 8.8.8.8" value="{{ domain if domain else '' }}">
            <button type="submit">Inspect</button>
        </div>
    </form>
    <!-- Panels row: DNS, WHOIS, CURL, Analysis -->
    <div class="panels-row">
    <!-- DNS Info Panel -->
    <div class="panel">
            <div class="panel-header dns">DNS Info{% if domain %} for <span class="checked-domain-name">{{ domain }}</span>{% endif %}</div>
            <div class="panel-body">
                {# DNS info table #}
                {% if domain_info and domain_info.dns %}
                <table style="width:100%; border-collapse:collapse; font-size:0.89em;">
                    <tbody>
                        <!-- DNS A Record Row -->
                        <tr>
                            <td class="dns-record-label" style="width: 95px; padding: 0.25em 0.4em; font-weight: normal; vertical-align: top; white-space:nowrap;">A</td>
                            <td style="padding: 0.25em 1.2em; vertical-align: top;">
                                {% if domain_info.dns.A and domain_info.dns.A|length > 0 %}
                                    <div>
                                        {% for ip in domain_info.dns.A[:4] %}
                                            <div class="dns-output" style="white-space:nowrap;">{{ ip }}</div>
                                        {% endfor %}
                                    </div>
                                {% else %}
                                    <span class="dns-output">No A records found</span>
                                {% endif %}
                            </td>
                        </tr>
                        <!-- DNS WWW A Record Row -->
                        <tr>
                            <td class="dns-record-label" style="width: 95px; padding: 0.25em 0.4em; font-weight: normal; vertical-align: top; white-space:nowrap;">WWW</td>
                            <td style="padding: 0.25em 1.2em; vertical-align: top;">
                                {% if domain_info.dns.WWW_A and domain_info.dns.WWW_A|length > 0 %}
                                    <div>
                                        {% for ip in domain_info.dns.WWW_A[:4] %}
                                            <div class="dns-output" style="white-space:nowrap;">{{ ip }}</div>
                                        {% endfor %}
                                    </div>
                                {% else %}
                                    <span class="dns-output">No WWW A records found</span>
                                {% endif %}
                            </td>
                        </tr>
                        <!-- DNS IPv6 Row -->
                        <tr>
                            <td class="dns-record-label" style="width: 95px; padding: 0.25em 0.4em; font-weight: normal; vertical-align: top; white-space:nowrap;">IPv6</td>
                                <td style="padding: 0.25em 1.2em; vertical-align: top;">
                                {% if domain_info.dns.AAAA and domain_info.dns.AAAA|length > 0 %}
                                    <span class="dns-output">{{ domain_info.dns.AAAA | join(' ') }}</span>
                                {% else %}
                                    <span class="dns-output">No IPv6 Found</span>
                                {% endif %}
                            </td>
                        </tr>
                        <!-- DNS TXT Row -->
                        <tr>
                            <td class="dns-record-label" style="width: 95px; padding: 0.25em 0.4em; font-weight: normal; vertical-align: top; white-space:nowrap;">TXT</td>
                                <td style="padding: 0.25em 1.2em; vertical-align: top;">
                                {% if domain_info.dns.TXT and domain_info.dns.TXT|length > 0 %}
                                    <div class="long-txt-record">
                                        {% for txt in domain_info.dns.TXT %}
                                            <div class="dns-output" style="margin-bottom:0.3em; white-space:nowrap; overflow-x:auto; text-overflow:ellipsis;">{{ txt }}</div>
                                        {% endfor %}
                                        {% if domain_info.dns.TXT|length > 4 %}
                                            <div style="position:absolute; left:0; right:0; bottom:0; height:2em; pointer-events:none; background:linear-gradient(to bottom, rgba(249,250,252,0) 0%, rgba(249,250,252,0.95) 100%);"></div>
                                        {% endif %}
                                    </div>
                                {% else %}
                                    <span class="dns-output">No TXT records found</span>
                                {% endif %}
                            </td>
                        </tr>
                        <!-- DNS MX Row -->
                        <tr>
                            <td class="dns-record-label" style="width: 95px; padding: 0.25em 0.4em; font-weight: normal; vertical-align: top; white-space:nowrap;">MX</td>
                                <td style="padding: 0.25em 1.2em;">
                                {% if domain_info.dns.MX and domain_info.dns.MX|length > 0 %}
                                    <div>
                                        {% for mx in domain_info.dns.MX %}
                                            <div class="dns-output" style="white-space:nowrap; overflow-x:auto; max-width:100%; scrollbar-width:none; -ms-overflow-style:none;">{{ mx }}</div>
                                        {% endfor %}
                                    </div>
                                {% else %}
                                    <span class="dns-output">No MX records found</span>
                                {% endif %}
                            </td>
                        </tr>
                        <!-- DNS NS Row -->
                        <tr>
                            <td class="dns-record-label" style="width: 95px; padding: 0.25em 0.4em; font-weight: normal; vertical-align: top;">NS</td>
                                <td style="padding: 0.25em 1.2em; vertical-align: top;">
                                {% if domain_info.dns.NS and domain_info.dns.NS|length > 0 %}
                                    <div>
                                        {% for ns in domain_info.dns.NS %}
                                            <div class="dns-output" style="white-space:nowrap;">{{ ns }}</div>
                                        {% endfor %}
                                    </div>
                                {% else %}
                                    <span class="dns-output">No NS records found</span>
                                {% endif %}
                            </td>
                        </tr>
                        <!-- DNSSEC Row -->
                        <tr>
                            <td class="dns-record-label" style="width: 95px; padding: 0.25em 0.4em; font-weight: normal; vertical-align: top;">DNSSEC</td>
                                <td style="word-break:break-all; padding: 0.25em 1.2em;">
                                {% if domain_info.dns.dnssec %}
                                    <span class="dns-output">Enabled</span>
                                {% else %}
                                    <span class="dns-output">Not enabled</span>
                                {% endif %}
                            </td>
                        </tr>
                    </tbody>
                </table>
            {% else %}
                <!-- No DNS info message -->
                <div class="text-muted">No DNS info yet.</div>
            {% endif %}
            </div>
        </div>
    <!-- WHOIS Info Panel -->
    <div class="panel">
            <div class="panel-header whois">WHOIS Info{% if domain %} for <span class="checked-domain-name">{{ domain }}</span>{% endif %}</div>
            <div class="panel-body">
                {# WHOIS info block #}
                {% if domain_info and domain_info.whois %}
                    <!-- Registrar info -->
                    <div class="dns-output" style="margin-bottom:1em;">Registrar: {{ domain_info.whois.registrar }}</div>
                    <!-- Nameservers info -->
                    {% if domain_info.whois.nameservers %}
                        <div class="dns-output" style="margin-bottom:1em;">Nameservers:
                            {% for ns in domain_info.whois.nameservers %}
                                <span class="dns-output" style="display:block; margin-left:1em;">{{ ns }}</span>
                            {% endfor %}
                        </div>
                    {% endif %}
                    {# Hold status logic #}
                    {% set hold_statuses = domain_info.whois.statuses | select('in', ['clientHold', 'serverHold']) | list %}
                    <!-- Domain hold status -->
                    {% if hold_statuses and hold_statuses|length > 0 %}
                        <div class="dns-output" style="color:#d32f2f;">Status: {{ hold_statuses | join(', ') }}</div>
                    {% endif %}
                    <!-- Expired domain info -->
                    {% if domain_info.whois.expiration and domain_info.whois.expired %}
                        <div class="dns-output" style="color:#d32f2f;">Expired: {{ domain_info.whois.expiration }}</div>
                    {% endif %}
                    <!-- Raw WHOIS details -->
                    {% if domain_info.whois.raw %}
                        <details style="margin-top:1.5em;">
                            <summary style="font-size:1.08em; font-weight:500; cursor:pointer; color:#222; padding:0.2em 0;">Raw WHOIS</summary>
                            <div class="dns-output" style="margin-top:0.7em; background:#fff; border-radius:4px; padding:0.5em; font-size:0.97em; color:#222; max-height:12em; overflow-y:auto; white-space:pre-wrap; border:1px solid #e0e0e0;">
                                {{ domain_info.whois.raw }}
                            </div>
                        </details>
                    {% endif %}
                {% else %}
                    <!-- No WHOIS info message -->
                    <div class="text-muted">No WHOIS info yet.</div>
                {% endif %}
            </div>
        </div>
    <!-- CURL Info Panel -->
    <div class="panel">
            <div class="panel-header curl">CURL GET Info{% if domain %} for <span class="checked-domain-name">{{ domain }}</span>{% endif %}</div>
            <div class="panel-body">
                {# CURL output block #}
                {% if curl_info and curl_info.headers %}
                    <!-- CURL output lines -->
                    <div style="background:#f9fafc; border-radius:4px; padding:0.5em; font-size:0.97em; color:#333; width:100%; box-sizing:border-box;">
                        {% for line in curl_info.headers.split('\n') %}
                            <!-- Individual CURL header line -->
                            <div class="dns-output" style="white-space:nowrap; overflow-x:hidden; text-overflow:ellipsis;">{{ line }}</div>
                        {% endfor %}
                    </div>
                {% else %}
                    <!-- No CURL info message -->
                    <div class="text-muted">No CURL info yet.</div>
                {% endif %}
            </div>
        </div>
    <!-- Analysis Panel -->
    <div class="panel">
            <div class="panel-header analysis">Analysis</div>
            <div class="panel-body">
                {# Analysis summary block #}
                {% if has_ipv6 or has_dnssec %}
                    {# Analysis summary title logic #}
                    {% if has_ipv6 and has_dnssec %}
                        {% set analysis_title = 'IPv6 & DNSSEC' %}
                    {% elif has_ipv6 %}
                        {% set analysis_title = 'IPv6 present' %}
                    {% elif has_dnssec %}
                        {% set analysis_title = 'DNSSEC present' %}
                    {% endif %}
                    <details style="margin-top:0.5em;">
                        <summary style="font-size:1.08em; font-weight:500; cursor:pointer; color:#222; padding:0.2em 0;">{{ analysis_title }}</summary>
                        <div style="padding:0.1em 0.2em;">
                            {% for item in analysis_dns %}
                                <!-- Individual analysis output line -->
                                <div class="dns-output" style="margin-bottom:0.1em; padding:0; color:#222;">
                                    - {{ item }}
                                </div>
                            {% endfor %}
                        </div>
                    </details>
                {% endif %}
            </div>
        </div>
    </div>
</div>
</body>
</html>